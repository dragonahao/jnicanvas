#ifndef _MULTIARRAY4D_
#define _MULTIARRAY4D_

#include "MultiArray.h"

class MultiArray4D: public MultiArray {
    private:
    protected:
    public:
        MultiArray4D(int rx, int ry, int rz, int rw);
        virtual ~MultiArray4D();

        const double& operator()(int nx, int ny, int nz, int nw) const;
              double& operator()(int nx, int ny, int nz, int nw);
};

inline const double& MultiArray4D::operator()(int nx, int ny, int nz, int nw) const {
    return storage_[range_[1]*range_[2]*range_[3]*nx + range_[2]*range_[3]*ny + range_[3]*nz + nw];
}

inline double& MultiArray4D::operator()(int nx, int ny, int nz, int nw){
    return storage_[range_[1]*range_[2]*range_[3]*nx + range_[2]*range_[3]*ny + range_[3]*nz + nw];
}

#endif // _MULTIARRAY4D_

